<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Boost Steam</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

:root {
  --bg: #0e1621;
  --bg2: #17212b;
  --bg3: #1e2c3a;
  --card: #1a2734;
  --card-hover: #1f3044;
  --accent: #4fc3f7;
  --accent2: #00e5ff;
  --accent-glow: rgba(79,195,247,0.15);
  --green: #66bb6a;
  --orange: #ffa726;
  --red: #ef5350;
  --text: #e8edf2;
  --text2: #8b9eb0;
  --text3: #5c7185;
  --border: #263545;
  --radius: 12px;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Chakra Petch', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-tap-highlight-color: transparent;
}

/* ‚îÄ‚îÄ Background effect ‚îÄ‚îÄ */
body::before {
  content: '';
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: 
    radial-gradient(ellipse at 20% 20%, rgba(79,195,247,0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 80%, rgba(0,229,255,0.04) 0%, transparent 50%);
  z-index: -1;
  animation: bgShift 20s ease-in-out infinite alternate;
}
@keyframes bgShift {
  0% { transform: translate(0,0) rotate(0deg); }
  100% { transform: translate(-3%,-3%) rotate(2deg); }
}

/* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
.header {
  padding: 20px 16px 16px;
  text-align: center;
  position: relative;
}
.header::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 16px;
  right: 16px;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--border), transparent);
}
.logo {
  font-size: 28px;
  font-weight: 700;
  letter-spacing: 2px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-transform: uppercase;
}
.logo-sub {
  font-size: 12px;
  color: var(--text3);
  letter-spacing: 4px;
  text-transform: uppercase;
  margin-top: 4px;
}
.balance-bar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  margin-top: 12px;
  padding: 8px 16px;
  background: var(--bg3);
  border-radius: 20px;
  display: inline-flex;
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px;
}
.balance-bar .bal-icon { font-size: 16px; }
.balance-bar .bal-amount { color: var(--green); font-weight: 500; }

.lang-toggle {
  position: absolute;
  top: 12px;
  right: 12px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 4px 10px;
  color: var(--text2);
  font-size: 12px;
  font-family: 'JetBrains Mono', monospace;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 10;
}
.lang-toggle:hover { color: var(--accent); border-color: var(--accent); }

/* ‚îÄ‚îÄ Navigation tabs ‚îÄ‚îÄ */
.nav {
  display: flex;
  padding: 12px 16px 0;
  gap: 4px;
  overflow-x: auto;
  scrollbar-width: none;
}
.nav::-webkit-scrollbar { display: none; }
.nav-tab {
  padding: 8px 16px;
  font-family: 'Chakra Petch', sans-serif;
  font-size: 13px;
  font-weight: 500;
  color: var(--text3);
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.2s;
}
.nav-tab.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}
.nav-tab:hover { color: var(--text2); }

/* ‚îÄ‚îÄ Content area ‚îÄ‚îÄ */
.content {
  padding: 16px;
}

/* ‚îÄ‚îÄ Service grid ‚îÄ‚îÄ */
.services-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.svc-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}
.svc-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  opacity: 0;
  transition: opacity 0.2s;
}
.svc-card:active, .svc-card:hover {
  background: var(--card-hover);
  transform: translateY(-1px);
}
.svc-card:active::before, .svc-card:hover::before { opacity: 1; }
.svc-icon { font-size: 24px; margin-bottom: 8px; }
.svc-name {
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 4px;
  line-height: 1.3;
}
.svc-price {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  color: var(--accent);
}
.svc-desc {
  font-size: 11px;
  color: var(--text3);
  margin-top: 4px;
  line-height: 1.3;
}

/* ‚îÄ‚îÄ Coming soon cards ‚îÄ‚îÄ */
.coming-card {
  background: var(--card);
  border: 1px dashed var(--border);
  border-radius: var(--radius);
  padding: 20px;
  text-align: center;
  margin-bottom: 10px;
}
.coming-card .emoji { font-size: 32px; margin-bottom: 8px; }
.coming-card .title { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
.coming-card .sub { font-size: 12px; color: var(--text3); }

/* ‚îÄ‚îÄ Order form ‚îÄ‚îÄ */
.order-panel {
  display: none;
  animation: slideUp 0.25s ease;
}
.order-panel.active { display: block; }
@keyframes slideUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}
.order-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}
.back-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: var(--bg3);
  border: 1px solid var(--border);
  color: var(--text);
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s;
}
.back-btn:active { background: var(--card-hover); }
.order-title { font-size: 18px; font-weight: 600; }

.form-group {
  margin-bottom: 16px;
}
.form-label {
  font-size: 12px;
  font-weight: 500;
  color: var(--text2);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 6px;
}
.form-input {
  width: 100%;
  padding: 12px 14px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  outline: none;
  transition: border-color 0.2s;
}
.form-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px var(--accent-glow);
}
.form-input::placeholder { color: var(--text3); }

.presets {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-top: 8px;
}
.preset-btn {
  padding: 6px 14px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px;
  background: var(--bg3);
  border: 1px solid var(--border);
  border-radius: 20px;
  color: var(--text2);
  cursor: pointer;
  transition: all 0.15s;
}
.preset-btn:active, .preset-btn.active {
  background: var(--accent);
  color: var(--bg);
  border-color: var(--accent);
}

.order-summary {
  background: var(--bg3);
  border-radius: var(--radius);
  padding: 14px;
  margin-bottom: 16px;
}
.summary-row {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
  font-size: 13px;
}
.summary-row .label { color: var(--text2); }
.summary-row .value { font-family: 'JetBrains Mono', monospace; }
.summary-row.total {
  border-top: 1px solid var(--border);
  margin-top: 8px;
  padding-top: 8px;
  font-weight: 600;
  font-size: 15px;
}
.summary-row.total .value { color: var(--accent); }

.submit-btn {
  width: 100%;
  padding: 14px;
  font-family: 'Chakra Petch', sans-serif;
  font-size: 15px;
  font-weight: 600;
  letter-spacing: 1px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: var(--bg);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.2s;
  text-transform: uppercase;
}
.submit-btn:active { transform: scale(0.98); opacity: 0.9; }
.submit-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  transform: none;
}

/* ‚îÄ‚îÄ Toast ‚îÄ‚îÄ */
.toast {
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  padding: 10px 20px;
  background: var(--green);
  color: var(--bg);
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  opacity: 0;
  transition: all 0.3s;
  z-index: 100;
  pointer-events: none;
}
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
.toast.error { background: var(--red); }

/* ‚îÄ‚îÄ Loading ‚îÄ‚îÄ */
.loading {
  display: flex;
  justify-content: center;
  padding: 40px;
}
.spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>
<body>

<div class="header">
  <div class="logo">Boost Steam</div>
  <div class="logo-sub">Promotion Services</div>
  <button class="lang-toggle" id="langToggle" onclick="toggleLang()">üåê EN</button>
  <div class="balance-bar" id="balanceBar" style="display:none">
    <span class="bal-icon">üí∞</span>
    <span class="bal-amount" id="balAmount">$0.00</span>
  </div>
</div>

<div class="nav">
  <button class="nav-tab active" data-tab="services">üõí –£—Å–ª—É–≥–∏</button>
  <button class="nav-tab" data-tab="dota">üó°Ô∏è –î–æ—Ç–∞ 2</button>
  <button class="nav-tab" data-tab="accounts">üéÆ –ê–∫–∫–∞—É–Ω—Ç—ã</button>
</div>

<div class="content">
  <!-- Services tab -->
  <div id="tab-services" class="tab-content">
    <div class="services-grid" id="servicesGrid"></div>
  </div>

  <!-- Dota tab -->
  <div id="tab-dota" class="tab-content" style="display:none">
    <div class="coming-card">
      <div class="emoji">üó°Ô∏è</div>
      <div class="title">Collectors Dota 2 –°–µ—Ç—ã</div>
      <div class="sub">–†–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω</div>
    </div>
  </div>

  <!-- Accounts tab -->
  <div id="tab-accounts" class="tab-content" style="display:none">
    <div class="coming-card">
      <div class="emoji">üéÆ</div>
      <div class="title">–ê–∫–∫–∞—É–Ω—Ç—ã —Å –∏–≥—Ä–∞–º–∏</div>
      <div class="sub">–†–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω</div>
    </div>
  </div>

  <!-- Order panel -->
  <div class="order-panel" id="orderPanel">
    <div class="order-header">
      <button class="back-btn" onclick="closeOrder()">‚Üê</button>
      <div class="order-title" id="orderTitle"></div>
    </div>

    <div class="form-group">
      <div class="form-label">–°—Å—ã–ª–∫–∞ Steam</div>
      <input class="form-input" id="targetUrl" placeholder="https://steamcommunity.com/..." autocomplete="off">
    </div>

    <div class="form-group">
      <div class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
      <input class="form-input" id="amountInput" type="number" placeholder="0" inputmode="numeric">
      <div class="presets" id="presets"></div>
    </div>

    <div class="order-summary" id="orderSummary" style="display:none">
      <div class="summary-row">
        <span class="label">–£—Å–ª—É–≥–∞</span>
        <span class="value" id="sumService"></span>
      </div>
      <div class="summary-row">
        <span class="label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span>
        <span class="value" id="sumAmount"></span>
      </div>
      <div class="summary-row total">
        <span class="label">–ò—Ç–æ–≥–æ</span>
        <span class="value" id="sumTotal"></span>
      </div>
    </div>

    <button class="submit-btn" id="submitBtn" disabled onclick="submitOrder()">
      –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
    </button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

// Theme
if (tg.colorScheme === 'light') {
  document.documentElement.style.setProperty('--bg', '#f5f5f5');
  document.documentElement.style.setProperty('--bg2', '#ffffff');
  document.documentElement.style.setProperty('--bg3', '#e8e8e8');
  document.documentElement.style.setProperty('--card', '#ffffff');
  document.documentElement.style.setProperty('--card-hover', '#f0f0f0');
  document.documentElement.style.setProperty('--text', '#1a1a1a');
  document.documentElement.style.setProperty('--text2', '#666');
  document.documentElement.style.setProperty('--text3', '#999');
  document.documentElement.style.setProperty('--border', '#ddd');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  LOCALIZATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const I18N = {
  ru: {
    tab_services: 'üõí –£—Å–ª—É–≥–∏', tab_dota: 'üó°Ô∏è –î–æ—Ç–∞ 2', tab_accounts: 'üéÆ –ê–∫–∫–∞—É–Ω—Ç—ã',
    steam_url: '–°—Å—ã–ª–∫–∞ Steam', steam_url_ph: 'https://steamcommunity.com/...',
    amount: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', summary_service: '–£—Å–ª—É–≥–∞', summary_amount: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
    summary_total: '–ò—Ç–æ–≥–æ', submit: '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑', order_sent: '‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!',
    per_unit: '—à—Ç',
    coming_dota_title: 'Collectors Dota 2 –°–µ—Ç—ã', coming_dota_sub: '–†–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω',
    coming_acc_title: '–ê–∫–∫–∞—É–Ω—Ç—ã —Å –∏–≥—Ä–∞–º–∏', coming_acc_sub: '–†–∞–∑–¥–µ–ª —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω',
  },
  en: {
    tab_services: 'üõí Services', tab_dota: 'üó°Ô∏è Dota 2', tab_accounts: 'üéÆ Accounts',
    steam_url: 'Steam URL', steam_url_ph: 'https://steamcommunity.com/...',
    amount: 'Amount', summary_service: 'Service', summary_amount: 'Amount',
    summary_total: 'Total', submit: 'Place Order', order_sent: '‚úÖ Order submitted!',
    per_unit: 'ea',
    coming_dota_title: 'Collectors Dota 2 Sets', coming_dota_sub: 'Coming soon',
    coming_acc_title: 'Game Accounts', coming_acc_sub: 'Coming soon',
  }
};

const SVC_I18N = {
  ru: {
    like:           {name:'–õ–∞–π–∫–∏',               desc:'–°–∫—Ä–∏–Ω—à–æ—Ç—ã, –∞—Ä—Ç—ã, –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è'},
    dislike:        {name:'–î–∏–∑–ª–∞–π–∫–∏',             desc:'–°–∫—Ä–∏–Ω—à–æ—Ç—ã, –∞—Ä—Ç—ã, –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è'},
    comment:        {name:'–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏',          desc:'–ü—Ä–æ—Ñ–∏–ª–∏ Steam'},
    favorite:       {name:'–ò–∑–±—Ä–∞–Ω–Ω–æ–µ',            desc:'–ü—Ä–µ–¥–º–µ—Ç—ã –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π'},
    workshop_sub:   {name:'–ü–æ–¥–ø–∏—Å–∫–∏ (–ø—Ä–µ–¥–º–µ—Ç)',    desc:'–ü—Ä–µ–¥–º–µ—Ç—ã –∏ –≥–∞–π–¥—ã'},
    workshop:       {name:'–ü–æ–¥–ø–∏—Å–∫–∏ (–º–∞—Å—Ç–µ—Ä—Å–∫–∞—è)', desc:'–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'},
    group:          {name:'–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã',      desc:'Steam –≥—Ä—É–ø–ø—ã'},
    friend:         {name:'–ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è',       desc:'–ü—Ä–æ—Ñ–∏–ª–∏ Steam'},
    wishlist:       {name:'–í–∏—à–ª–∏—Å—Ç',              desc:'–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã –≤ –≤–∏—à–ª–∏—Å—Ç'},
    view:           {name:'–ü—Ä–æ—Å–º–æ—Ç—Ä—ã',            desc:'–°–∫—Ä–∏–Ω—à–æ—Ç—ã, –∞—Ä—Ç—ã, –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è'},
    curator:        {name:'–ü–æ–¥–ø–∏—Å–∫–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞',    desc:'Steam –∫—É—Ä–∞—Ç–æ—Ä—ã'},
    review_like:    {name:'–õ–∞–π–∫–∏ –Ω–∞ –æ–±–∑–æ—Ä—ã',      desc:'–û–±–∑–æ—Ä—ã Steam'},
    review_comment: {name:'–ö–æ–º–º–µ–Ω—Ç—ã –Ω–∞ –æ–±–∑–æ—Ä—ã',   desc:'–û–±–∑–æ—Ä—ã Steam'},
  },
  en: {
    like:           {name:'Likes',                desc:'Screenshots, artworks, workshop'},
    dislike:        {name:'Dislikes',             desc:'Screenshots, artworks, workshop'},
    comment:        {name:'Comments',             desc:'Steam profiles'},
    favorite:       {name:'Favorites',            desc:'Workshop items'},
    workshop_sub:   {name:'Subscriptions (item)',  desc:'Items and guides'},
    workshop:       {name:'Subscriptions (workshop)', desc:'User workshop'},
    group:          {name:'Group Members',        desc:'Steam groups'},
    friend:         {name:'Friend Requests',      desc:'Steam profiles'},
    wishlist:       {name:'Wishlist',             desc:'Add game to wishlist'},
    view:           {name:'Views',                desc:'Screenshots, artworks, workshop'},
    curator:        {name:'Curator Follows',      desc:'Steam curators'},
    review_like:    {name:'Review Likes',         desc:'Steam reviews'},
    review_comment: {name:'Review Comments',      desc:'Steam reviews'},
  }
};

// Detect language: URL param > Telegram user language
let currentLang = 'en';
const urlParams = new URLSearchParams(window.location.search);
const urlLang = urlParams.get('lang');
if (urlLang === 'ru' || urlLang === 'en') {
  currentLang = urlLang;
} else if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
  const tgLang = (tg.initDataUnsafe.user.language_code || '').substring(0, 2);
  currentLang = (tgLang === 'ru' || tgLang === 'uk' || tgLang === 'be') ? 'ru' : 'en';
}

function tr(key) {
  return (I18N[currentLang] || I18N.en)[key] || key;
}
function svcName(key) {
  return ((SVC_I18N[currentLang] || SVC_I18N.en)[key] || {}).name || key;
}
function svcDesc(key) {
  return ((SVC_I18N[currentLang] || SVC_I18N.en)[key] || {}).desc || '';
}

function toggleLang() {
  currentLang = currentLang === 'ru' ? 'en' : 'ru';
  document.getElementById('langToggle').textContent = 'üåê ' + currentLang.toUpperCase();
  applyLang();
}

function applyLang() {
  // Tabs
  const tabs = document.querySelectorAll('.nav-tab');
  tabs[0].textContent = tr('tab_services');
  tabs[1].textContent = tr('tab_dota');
  tabs[2].textContent = tr('tab_accounts');

  // Coming soon
  const dotaCard = document.querySelector('#tab-dota .coming-card');
  if (dotaCard) {
    dotaCard.querySelector('.title').textContent = tr('coming_dota_title');
    dotaCard.querySelector('.sub').textContent = tr('coming_dota_sub');
  }
  const accCard = document.querySelector('#tab-accounts .coming-card');
  if (accCard) {
    accCard.querySelector('.title').textContent = tr('coming_acc_title');
    accCard.querySelector('.sub').textContent = tr('coming_acc_sub');
  }

  // Order panel labels
  const formLabels = document.querySelectorAll('#orderPanel .form-label');
  if (formLabels[0]) formLabels[0].textContent = tr('steam_url');
  if (formLabels[1]) formLabels[1].textContent = tr('amount');
  document.getElementById('targetUrl').placeholder = tr('steam_url_ph');

  const summaryLabels = document.querySelectorAll('.summary-row .label');
  if (summaryLabels[0]) summaryLabels[0].textContent = tr('summary_service');
  if (summaryLabels[1]) summaryLabels[1].textContent = tr('summary_amount');
  if (summaryLabels[2]) summaryLabels[2].textContent = tr('summary_total');
  document.getElementById('submitBtn').textContent = tr('submit');

  renderServices();
}

// ‚îÄ‚îÄ Services data ‚îÄ‚îÄ
const SERVICES = {
  like:           {icon:'üëç', price:0.008, min:10, max:1125, presets:[10,50,100,500,1125]},
  dislike:        {icon:'üëé', price:0.008, min:10, max:1125, presets:[10,50,100,500,1125]},
  comment:        {icon:'üí¨', price:0.014, min:10, max:1125, presets:[10,50,100,500,1125]},
  favorite:       {icon:'‚≠ê', price:0.01,  min:10, max:1125, presets:[10,50,100,500,1125]},
  workshop_sub:   {icon:'üì•', price:0.013, min:10, max:1125, presets:[10,50,100,500,1125]},
  workshop:       {icon:'üîß', price:0.013, min:10, max:1125, presets:[10,50,100,500,1125]},
  group:          {icon:'üë•', price:0.01,  min:10, max:1125, presets:[10,50,100,500,1125]},
  friend:         {icon:'ü§ù', price:0.021, min:10, max:200,  presets:[10,50,100,200]},
  wishlist:       {icon:'üíù', price:0.01,  min:10, max:1125, presets:[10,50,100,500,1125]},
  view:           {icon:'üëÅ', price:0.005, min:50, max:1125, presets:[50,100,200,500,1125]},
  curator:        {icon:'üì¢', price:0.01,  min:10, max:1125, presets:[10,50,100,500,1125]},
  review_like:    {icon:'üìù', price:0.008, min:10, max:1125, presets:[10,50,100,500,1125]},
  review_comment: {icon:'üí≠', price:0.014, min:10, max:1125, presets:[10,50,100,500,1125]},
};

let currentService = null;
let userBalance = 0;

// ‚îÄ‚îÄ Render services ‚îÄ‚îÄ
function renderServices() {
  const grid = document.getElementById('servicesGrid');
  grid.innerHTML = '';
  for (const [key, svc] of Object.entries(SERVICES)) {
    const card = document.createElement('div');
    card.className = 'svc-card';
    card.onclick = () => openOrder(key);
    card.innerHTML = `
      <div class="svc-icon">${svc.icon}</div>
      <div class="svc-name">${svcName(key)}</div>
      <div class="svc-price">$${svc.price}/${tr('per_unit')}</div>
      <div class="svc-desc">${svcDesc(key)}</div>
    `;
    grid.appendChild(card);
  }
}

// ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ
document.querySelectorAll('.nav-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    const target = tab.dataset.tab;
    document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
    document.getElementById('tab-' + target).style.display = '';
    document.getElementById('orderPanel').classList.remove('active');
  });
});

// ‚îÄ‚îÄ Order flow ‚îÄ‚îÄ
function openOrder(key) {
  currentService = key;
  const svc = SERVICES[key];
  
  document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
  const panel = document.getElementById('orderPanel');
  panel.classList.add('active');
  
  document.getElementById('orderTitle').textContent = svc.icon + ' ' + svcName(key);
  document.getElementById('targetUrl').value = '';
  document.getElementById('amountInput').value = '';
  document.getElementById('amountInput').min = svc.min;
  document.getElementById('amountInput').max = svc.max;
  document.getElementById('amountInput').placeholder = `${svc.min} ‚Äî ${svc.max}`;
  document.getElementById('orderSummary').style.display = 'none';
  document.getElementById('submitBtn').disabled = true;
  
  const presetsEl = document.getElementById('presets');
  presetsEl.innerHTML = '';
  svc.presets.forEach(p => {
    const btn = document.createElement('button');
    btn.className = 'preset-btn';
    btn.textContent = p;
    btn.onclick = () => {
      document.getElementById('amountInput').value = p;
      document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      updateSummary();
    };
    presetsEl.appendChild(btn);
  });
  
  tg.BackButton.show();
  tg.BackButton.onClick(closeOrder);
}

function closeOrder() {
  document.getElementById('orderPanel').classList.remove('active');
  const activeTab = document.querySelector('.nav-tab.active');
  const target = activeTab ? activeTab.dataset.tab : 'services';
  document.getElementById('tab-' + target).style.display = '';
  tg.BackButton.hide();
  currentService = null;
}

// ‚îÄ‚îÄ Summary ‚îÄ‚îÄ
document.getElementById('amountInput').addEventListener('input', updateSummary);
document.getElementById('targetUrl').addEventListener('input', updateSummary);

function updateSummary() {
  if (!currentService) return;
  const svc = SERVICES[currentService];
  const amount = parseInt(document.getElementById('amountInput').value) || 0;
  const url = document.getElementById('targetUrl').value.trim();
  const total = (amount * svc.price).toFixed(2);
  
  const valid = amount >= svc.min && amount <= svc.max && url.length > 10;
  
  document.getElementById('sumService').textContent = svcName(currentService);
  document.getElementById('sumAmount').textContent = amount;
  document.getElementById('sumTotal').textContent = '$' + total;
  document.getElementById('orderSummary').style.display = valid ? '' : 'none';
  document.getElementById('submitBtn').disabled = !valid;
}

// ‚îÄ‚îÄ Submit ‚îÄ‚îÄ
function submitOrder() {
  if (!currentService) return;
  const svc = SERVICES[currentService];
  const amount = parseInt(document.getElementById('amountInput').value) || 0;
  const url = document.getElementById('targetUrl').value.trim();
  const total = (amount * svc.price).toFixed(2);
  
  tg.sendData(JSON.stringify({
    action: 'order',
    service: currentService,
    amount: amount,
    target_url: url,
    total: total,
  }));
  showToast(tr('order_sent'));
  setTimeout(() => closeOrder(), 1000);
}

// ‚îÄ‚îÄ Toast ‚îÄ‚îÄ
function showToast(msg, isError) {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.className = 'toast show' + (isError ? ' error' : '');
  setTimeout(() => toast.className = 'toast', 2500);
}

// ‚îÄ‚îÄ Init ‚îÄ‚îÄ
document.getElementById('langToggle').textContent = 'üåê ' + currentLang.toUpperCase();
applyLang();

if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
  document.getElementById('balanceBar').style.display = 'inline-flex';
}
</script>
</body>
</html>
